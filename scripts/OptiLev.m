clear 
format long
tic
q = 1;
P = 21*10^3; 
Q = 165*10^3; 
a=1107.52; 
C=14.907; 
w=0.6; 
f = pi/4;
A = 1000.46;
c = 125.875;
n=0; 
R0= 10000;
% t0 =920;
% t1 = 1000;
% dt = 1;
dn =100000;
j = 0;
R = gpuArray(linspace(-R0,R0,dn));
R1 = gpuArray(linspace(0,R0,dn));
m = 3; 
 
RO=0; 
L=0;  
I=0;
 len = 1000;
 wid = 200;
It = gpuArray(zeros(size(R)));
% numt = (t1-t0)/dt;
numn = 200/dn;
t = 0;
I0=1;


n = 0;

%   wid = 206.14.*t.^4-472.28.*t.^3 + 189.1.*t.^2 - 197.08.*t + 432.49;
%   len = 171.78.*t.^4 - 393.57.*t.^3 + 157.58.*t.^2 - 164.23.*t + 432.49;
    
RO = 0.00000001;
% L = real(sqrt(complex((-(4.*(4.*R.*len.^4.*n.^3.*wid.^2.*cos(f).^2 - P.^4.*len.^2.*wid.^4.*cos(f).^2 - Q.^4.*len.^2.*wid.^4.*cos(f).^2 - R.^4.*len.^4.*wid.^2.*cos(f).^2 - P.^4.*len.^4.*wid.^2.*sin(f).^2 - Q.^4.*len.^4.*wid.^2.*sin(f).^2 - R.^4.*len.^2.*wid.^4.*sin(f).^2 - len.^4.*n.^4.*wid.^2.*cos(f).^2 - 4.*P.*Q.^3.*len.^2.*wid.^4.*cos(f).^2 - 4.*P.^3.*Q.*len.^2.*wid.^4.*cos(f).^2 - 4.*P.*Q.^3.*len.^4.*wid.^2.*sin(f).^2 - 4.*P.^3.*Q.*len.^4.*wid.^2.*sin(f).^2 - len.^2.*n.^4.*wid.^4.*sin(f).^2 + 4.*R.^3.*len.^4.*n.*wid.^2.*cos(f).^2 + 4.*R.*len.^2.*n.^3.*wid.^4.*sin(f).^2 + 4.*R.^3.*len.^2.*n.*wid.^4.*sin(f).^2 - 6.*P.^2.*Q.^2.*len.^2.*wid.^4.*cos(f).^2 - P.^2.*R.^2.*len.^2.*wid.^4.*cos(f).^2 - P.^2.*R.^2.*len.^4.*wid.^2.*cos(f).^2 + P.^2.*R.^4.*len.^2.*wid.^2.*cos(f).^4 + P.^4.*R.^2.*len.^2.*wid.^2.*cos(f).^4 - Q.^2.*R.^2.*len.^2.*wid.^4.*cos(f).^2 - Q.^2.*R.^2.*len.^4.*wid.^2.*cos(f).^2 - 6.*P.^2.*Q.^2.*len.^4.*wid.^2.*sin(f).^2 - P.^2.*R.^2.*len.^2.*wid.^4.*sin(f).^2 - P.^2.*R.^2.*len.^4.*wid.^2.*sin(f).^2 + P.^2.*R.^4.*len.^2.*wid.^2.*sin(f).^4 + P.^4.*R.^2.*len.^2.*wid.^2.*sin(f).^4 - Q.^2.*R.^2.*len.^2.*wid.^4.*sin(f).^2 - Q.^2.*R.^2.*len.^4.*wid.^2.*sin(f).^2 - P.^2.*len.^2.*n.^2.*wid.^4.*cos(f).^2 - P.^2.*len.^4.*n.^2.*wid.^2.*cos(f).^2 - Q.^2.*len.^2.*n.^2.*wid.^4.*cos(f).^2 - Q.^2.*len.^4.*n.^2.*wid.^2.*cos(f).^2 + Q.^2.*len.^2.*n.^4.*wid.^2.*cos(f).^4 + Q.^4.*len.^2.*n.^2.*wid.^2.*cos(f).^4 - 6.*R.^2.*len.^4.*n.^2.*wid.^2.*cos(f).^2 - P.^2.*len.^2.*n.^2.*wid.^4.*sin(f).^2 - P.^2.*len.^4.*n.^2.*wid.^2.*sin(f).^2 - Q.^2.*len.^2.*n.^2.*wid.^4.*sin(f).^2 - Q.^2.*len.^4.*n.^2.*wid.^2.*sin(f).^2 + Q.^2.*len.^2.*n.^4.*wid.^2.*sin(f).^4 + Q.^4.*len.^2.*n.^2.*wid.^2.*sin(f).^4 - 6.*R.^2.*len.^2.*n.^2.*wid.^4.*sin(f).^2 + 2.*P.*Q.^3.*len.^2.*n.^2.*wid.^2.*sin(f).^4 - 2.*P.^2.*R.^3.*len.^2.*n.*wid.^2.*sin(f).^4 - 2.*Q.^2.*R.*len.^2.*n.^3.*wid.^2.*sin(f).^4 + P.^2.*Q.^2.*R.^2.*len.^2.*wid.^2.*cos(f).^4 + P.^2.*Q.^2.*R.^2.*len.^2.*wid.^2.*sin(f).^4 + P.^2.*Q.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + P.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + Q.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + P.^2.*Q.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 + P.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 + Q.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 - 2.*P.*Q.*R.^2.*len.^2.*wid.^4.*cos(f).^2 - 2.*P.*Q.*R.^2.*len.^4.*wid.^2.*cos(f).^2 - 2.*P.*Q.*R.^2.*len.^2.*wid.^4.*sin(f).^2 - 2.*P.*Q.*R.^2.*len.^4.*wid.^2.*sin(f).^2 - 2.*P.*Q.*len.^2.*n.^2.*wid.^4.*cos(f).^2 - 2.*P.*Q.*len.^4.*n.^2.*wid.^2.*cos(f).^2 + 2.*P.^2.*R.*len.^2.*n.*wid.^4.*cos(f).^2 + 2.*P.^2.*R.*len.^4.*n.*wid.^2.*cos(f).^2 + 2.*Q.^2.*R.*len.^2.*n.*wid.^4.*cos(f).^2 + 2.*Q.^2.*R.*len.^4.*n.*wid.^2.*cos(f).^2 - 2.*P.*R.^3.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*P.*R.^3.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*P.^3.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*P.^3.*R.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*Q.*R.^3.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*Q.*R.^3.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*Q.^3.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*Q.^3.*R.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*P.*Q.*len.^2.*n.^2.*wid.^4.*sin(f).^2 - 2.*P.*Q.*len.^4.*n.^2.*wid.^2.*sin(f).^2 + 2.*P.^2.*R.*len.^2.*n.*wid.^4.*sin(f).^2 + 2.*P.^2.*R.*len.^4.*n.*wid.^2.*sin(f).^2 + 2.*Q.^2.*R.*len.^2.*n.*wid.^4.*sin(f).^2 + 2.*Q.^2.*R.*len.^4.*n.*wid.^2.*sin(f).^2 + 2.*P.*len.^2.*n.^3.*wid.^4.*cos(f).*sin(f) - 2.*P.*len.^4.*n.^3.*wid.^2.*cos(f).*sin(f) + 2.*P.^3.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 2.*P.^3.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 2.*Q.*len.^2.*n.^3.*wid.^4.*cos(f).*sin(f) - 2.*Q.*len.^4.*n.^3.*wid.^2.*cos(f).*sin(f) + 2.*Q.^3.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 2.*Q.^3.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 2.*P.^2.*R.^4.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*P.^4.*R.^2.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*Q.^2.*len.^2.*n.^4.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*Q.^4.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*P.^3.*Q.*R.^2.*len.^2.*wid.^2.*cos(f).^4 + 2.*P.^3.*Q.*R.^2.*len.^2.*wid.^2.*sin(f).^4 + 2.*P.*Q.^3.*len.^2.*n.^2.*wid.^2.*cos(f).^4 - 2.*P.^2.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^4 - 2.*Q.^2.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^4 + 6.*P.*Q.^2.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*P.*Q.^2.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 6.*P.^2.*Q.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*P.^2.*Q.*len.^4.*n.*wid.^2.*cos(f).*sin(f) - 6.*P.*R.*len.^2.*n.^2.*wid.^4.*cos(f).*sin(f) + 6.*P.*R.*len.^4.*n.^2.*wid.^2.*cos(f).*sin(f) + 6.*P.*R.^2.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*P.*R.^2.*len.^4.*n.*wid.^2.*cos(f).*sin(f) - 6.*Q.*R.*len.^2.*n.^2.*wid.^4.*cos(f).*sin(f) + 6.*Q.*R.*len.^4.*n.^2.*wid.^2.*cos(f).*sin(f) + 6.*Q.*R.^2.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*Q.*R.^2.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 4.*P.^3.*Q.*R.^2.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.^3.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 - 4.*P.^2.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 - 4.*Q.^2.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^2.*sin(f).^2 - 4.*P.*Q.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + 4.*P.^2.*Q.^2.*R.*len.^2.*n.*wid.^2.*cos(f).^4 - 4.*P.*Q.*R.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 + 4.*P.^2.*Q.^2.*R.*len.^2.*n.*wid.^2.*sin(f).^4 + 2.*P.^2.*Q.^2.*R.^2.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.*R.*len.^2.*n.*wid.^4.*cos(f).^2 + 4.*P.*Q.*R.*len.^4.*n.*wid.^2.*cos(f).^2 + 2.*P.^2.*Q.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*P.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*Q.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.*R.*len.^2.*n.*wid.^4.*sin(f).^2 + 4.*P.*Q.*R.*len.^4.*n.*wid.^2.*sin(f).^2 + 2.*P.*Q.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^4 + 2.*P.*Q.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^4 + 2.*P.*Q.^3.*R.*len.^2.*n.*wid.^2.*cos(f).^4 + 2.*P.^3.*Q.*R.*len.^2.*n.*wid.^2.*cos(f).^4 - 6.*P.*Q.^2.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 6.*P.*Q.^2.*R.*len.^4.*wid.^2.*cos(f).*sin(f) - 6.*P.^2.*Q.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 6.*P.^2.*Q.*R.*len.^4.*wid.^2.*cos(f).*sin(f) + 2.*P.*Q.*R.*len.^2.*n.^3.*wid.^2.*sin(f).^4 + 2.*P.*Q.*R.^3.*len.^2.*n.*wid.^2.*sin(f).^4 + 2.*P.*Q.^3.*R.*len.^2.*n.*wid.^2.*sin(f).^4 + 2.*P.^3.*Q.*R.*len.^2.*n.*wid.^2.*sin(f).^4 + 4.*P.*Q.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.^3.*R.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.^3.*Q.*R.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 - 8.*P.*Q.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 8.*P.^2.*Q.^2.*R.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2))./(P.^2.*len.^2.*sin(f).^2 + P.^2.*wid.^2.*cos(f).^2 + 2.*P.*Q.*len.^2.*sin(f).^2 + 2.*P.*Q.*wid.^2.*cos(f).^2 - 2.*P.*R.*len.^2.*cos(f).*sin(f) + 2.*P.*R.*wid.^2.*cos(f).*sin(f) + 2.*P.*len.^2.*n.*cos(f).*sin(f) - 2.*P.*n.*wid.^2.*cos(f).*sin(f) + Q.^2.*len.^2.*sin(f).^2 + Q.^2.*wid.^2.*cos(f).^2 - 2.*Q.*R.*len.^2.*cos(f).*sin(f) + 2.*Q.*R.*wid.^2.*cos(f).*sin(f) + 2.*Q.*len.^2.*n.*cos(f).*sin(f) - 2.*Q.*n.*wid.^2.*cos(f).*sin(f) + R.^2.*len.^2.*cos(f).^2 + R.^2.*wid.^2.*sin(f).^2 - 2.*R.*len.^2.*n.*cos(f).^2 - 2.*R.*n.*wid.^2.*sin(f).^2 + len.^2.*n.^2.*cos(f).^2 + n.^2.*wid.^2.*sin(f).^2).^2))));
l = (-(4.*(4.*R.*len.^4.*n.^3.*wid.^2.*cos(f).^2 - P.^4.*len.^2.*wid.^4.*cos(f).^2 - Q.^4.*len.^2.*wid.^4.*cos(f).^2 - R.^4.*len.^4.*wid.^2.*cos(f).^2 - P.^4.*len.^4.*wid.^2.*sin(f).^2 - Q.^4.*len.^4.*wid.^2.*sin(f).^2 - R.^4.*len.^2.*wid.^4.*sin(f).^2 - len.^4.*n.^4.*wid.^2.*cos(f).^2 - 4.*P.*Q.^3.*len.^2.*wid.^4.*cos(f).^2 - 4.*P.^3.*Q.*len.^2.*wid.^4.*cos(f).^2 - 4.*P.*Q.^3.*len.^4.*wid.^2.*sin(f).^2 - 4.*P.^3.*Q.*len.^4.*wid.^2.*sin(f).^2 - len.^2.*n.^4.*wid.^4.*sin(f).^2 + 4.*R.^3.*len.^4.*n.*wid.^2.*cos(f).^2 + 4.*R.*len.^2.*n.^3.*wid.^4.*sin(f).^2 + 4.*R.^3.*len.^2.*n.*wid.^4.*sin(f).^2 - 6.*P.^2.*Q.^2.*len.^2.*wid.^4.*cos(f).^2 - P.^2.*R.^2.*len.^2.*wid.^4.*cos(f).^2 - P.^2.*R.^2.*len.^4.*wid.^2.*cos(f).^2 + P.^2.*R.^4.*len.^2.*wid.^2.*cos(f).^4 + P.^4.*R.^2.*len.^2.*wid.^2.*cos(f).^4 - Q.^2.*R.^2.*len.^2.*wid.^4.*cos(f).^2 - Q.^2.*R.^2.*len.^4.*wid.^2.*cos(f).^2 - 6.*P.^2.*Q.^2.*len.^4.*wid.^2.*sin(f).^2 - P.^2.*R.^2.*len.^2.*wid.^4.*sin(f).^2 - P.^2.*R.^2.*len.^4.*wid.^2.*sin(f).^2 + P.^2.*R.^4.*len.^2.*wid.^2.*sin(f).^4 + P.^4.*R.^2.*len.^2.*wid.^2.*sin(f).^4 - Q.^2.*R.^2.*len.^2.*wid.^4.*sin(f).^2 - Q.^2.*R.^2.*len.^4.*wid.^2.*sin(f).^2 - P.^2.*len.^2.*n.^2.*wid.^4.*cos(f).^2 - P.^2.*len.^4.*n.^2.*wid.^2.*cos(f).^2 - Q.^2.*len.^2.*n.^2.*wid.^4.*cos(f).^2 - Q.^2.*len.^4.*n.^2.*wid.^2.*cos(f).^2 + Q.^2.*len.^2.*n.^4.*wid.^2.*cos(f).^4 + Q.^4.*len.^2.*n.^2.*wid.^2.*cos(f).^4 - 6.*R.^2.*len.^4.*n.^2.*wid.^2.*cos(f).^2 - P.^2.*len.^2.*n.^2.*wid.^4.*sin(f).^2 - P.^2.*len.^4.*n.^2.*wid.^2.*sin(f).^2 - Q.^2.*len.^2.*n.^2.*wid.^4.*sin(f).^2 - Q.^2.*len.^4.*n.^2.*wid.^2.*sin(f).^2 + Q.^2.*len.^2.*n.^4.*wid.^2.*sin(f).^4 + Q.^4.*len.^2.*n.^2.*wid.^2.*sin(f).^4 - 6.*R.^2.*len.^2.*n.^2.*wid.^4.*sin(f).^2 + 2.*P.*Q.^3.*len.^2.*n.^2.*wid.^2.*sin(f).^4 - 2.*P.^2.*R.^3.*len.^2.*n.*wid.^2.*sin(f).^4 - 2.*Q.^2.*R.*len.^2.*n.^3.*wid.^2.*sin(f).^4 + P.^2.*Q.^2.*R.^2.*len.^2.*wid.^2.*cos(f).^4 + P.^2.*Q.^2.*R.^2.*len.^2.*wid.^2.*sin(f).^4 + P.^2.*Q.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + P.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + Q.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + P.^2.*Q.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 + P.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 + Q.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 - 2.*P.*Q.*R.^2.*len.^2.*wid.^4.*cos(f).^2 - 2.*P.*Q.*R.^2.*len.^4.*wid.^2.*cos(f).^2 - 2.*P.*Q.*R.^2.*len.^2.*wid.^4.*sin(f).^2 - 2.*P.*Q.*R.^2.*len.^4.*wid.^2.*sin(f).^2 - 2.*P.*Q.*len.^2.*n.^2.*wid.^4.*cos(f).^2 - 2.*P.*Q.*len.^4.*n.^2.*wid.^2.*cos(f).^2 + 2.*P.^2.*R.*len.^2.*n.*wid.^4.*cos(f).^2 + 2.*P.^2.*R.*len.^4.*n.*wid.^2.*cos(f).^2 + 2.*Q.^2.*R.*len.^2.*n.*wid.^4.*cos(f).^2 + 2.*Q.^2.*R.*len.^4.*n.*wid.^2.*cos(f).^2 - 2.*P.*R.^3.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*P.*R.^3.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*P.^3.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*P.^3.*R.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*Q.*R.^3.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*Q.*R.^3.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*Q.^3.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 2.*Q.^3.*R.*len.^4.*wid.^2.*cos(f).*sin(f) - 2.*P.*Q.*len.^2.*n.^2.*wid.^4.*sin(f).^2 - 2.*P.*Q.*len.^4.*n.^2.*wid.^2.*sin(f).^2 + 2.*P.^2.*R.*len.^2.*n.*wid.^4.*sin(f).^2 + 2.*P.^2.*R.*len.^4.*n.*wid.^2.*sin(f).^2 + 2.*Q.^2.*R.*len.^2.*n.*wid.^4.*sin(f).^2 + 2.*Q.^2.*R.*len.^4.*n.*wid.^2.*sin(f).^2 + 2.*P.*len.^2.*n.^3.*wid.^4.*cos(f).*sin(f) - 2.*P.*len.^4.*n.^3.*wid.^2.*cos(f).*sin(f) + 2.*P.^3.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 2.*P.^3.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 2.*Q.*len.^2.*n.^3.*wid.^4.*cos(f).*sin(f) - 2.*Q.*len.^4.*n.^3.*wid.^2.*cos(f).*sin(f) + 2.*Q.^3.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 2.*Q.^3.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 2.*P.^2.*R.^4.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*P.^4.*R.^2.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*Q.^2.*len.^2.*n.^4.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*Q.^4.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*P.^3.*Q.*R.^2.*len.^2.*wid.^2.*cos(f).^4 + 2.*P.^3.*Q.*R.^2.*len.^2.*wid.^2.*sin(f).^4 + 2.*P.*Q.^3.*len.^2.*n.^2.*wid.^2.*cos(f).^4 - 2.*P.^2.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^4 - 2.*Q.^2.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^4 + 6.*P.*Q.^2.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*P.*Q.^2.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 6.*P.^2.*Q.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*P.^2.*Q.*len.^4.*n.*wid.^2.*cos(f).*sin(f) - 6.*P.*R.*len.^2.*n.^2.*wid.^4.*cos(f).*sin(f) + 6.*P.*R.*len.^4.*n.^2.*wid.^2.*cos(f).*sin(f) + 6.*P.*R.^2.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*P.*R.^2.*len.^4.*n.*wid.^2.*cos(f).*sin(f) - 6.*Q.*R.*len.^2.*n.^2.*wid.^4.*cos(f).*sin(f) + 6.*Q.*R.*len.^4.*n.^2.*wid.^2.*cos(f).*sin(f) + 6.*Q.*R.^2.*len.^2.*n.*wid.^4.*cos(f).*sin(f) - 6.*Q.*R.^2.*len.^4.*n.*wid.^2.*cos(f).*sin(f) + 4.*P.^3.*Q.*R.^2.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.^3.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 - 4.*P.^2.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 - 4.*Q.^2.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^2.*sin(f).^2 - 4.*P.*Q.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^4 + 4.*P.^2.*Q.^2.*R.*len.^2.*n.*wid.^2.*cos(f).^4 - 4.*P.*Q.*R.^2.*len.^2.*n.^2.*wid.^2.*sin(f).^4 + 4.*P.^2.*Q.^2.*R.*len.^2.*n.*wid.^2.*sin(f).^4 + 2.*P.^2.*Q.^2.*R.^2.*len.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.*R.*len.^2.*n.*wid.^4.*cos(f).^2 + 4.*P.*Q.*R.*len.^4.*n.*wid.^2.*cos(f).^2 + 2.*P.^2.*Q.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*P.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 2.*Q.^2.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.*R.*len.^2.*n.*wid.^4.*sin(f).^2 + 4.*P.*Q.*R.*len.^4.*n.*wid.^2.*sin(f).^2 + 2.*P.*Q.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^4 + 2.*P.*Q.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^4 + 2.*P.*Q.^3.*R.*len.^2.*n.*wid.^2.*cos(f).^4 + 2.*P.^3.*Q.*R.*len.^2.*n.*wid.^2.*cos(f).^4 - 6.*P.*Q.^2.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 6.*P.*Q.^2.*R.*len.^4.*wid.^2.*cos(f).*sin(f) - 6.*P.^2.*Q.*R.*len.^2.*wid.^4.*cos(f).*sin(f) + 6.*P.^2.*Q.*R.*len.^4.*wid.^2.*cos(f).*sin(f) + 2.*P.*Q.*R.*len.^2.*n.^3.*wid.^2.*sin(f).^4 + 2.*P.*Q.*R.^3.*len.^2.*n.*wid.^2.*sin(f).^4 + 2.*P.*Q.^3.*R.*len.^2.*n.*wid.^2.*sin(f).^4 + 2.*P.^3.*Q.*R.*len.^2.*n.*wid.^2.*sin(f).^4 + 4.*P.*Q.*R.*len.^2.*n.^3.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.*R.^3.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.*Q.^3.*R.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 + 4.*P.^3.*Q.*R.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2 - 8.*P.*Q.*R.^2.*len.^2.*n.^2.*wid.^2.*cos(f).^2.*sin(f).^2 + 8.*P.^2.*Q.^2.*R.*len.^2.*n.*wid.^2.*cos(f).^2.*sin(f).^2))./(P.^2.*len.^2.*sin(f).^2 + P.^2.*wid.^2.*cos(f).^2 + 2.*P.*Q.*len.^2.*sin(f).^2 + 2.*P.*Q.*wid.^2.*cos(f).^2 - 2.*P.*R.*len.^2.*cos(f).*sin(f) + 2.*P.*R.*wid.^2.*cos(f).*sin(f) + 2.*P.*len.^2.*n.*cos(f).*sin(f) - 2.*P.*n.*wid.^2.*cos(f).*sin(f) + Q.^2.*len.^2.*sin(f).^2 + Q.^2.*wid.^2.*cos(f).^2 - 2.*Q.*R.*len.^2.*cos(f).*sin(f) + 2.*Q.*R.*wid.^2.*cos(f).*sin(f) + 2.*Q.*len.^2.*n.*cos(f).*sin(f) - 2.*Q.*n.*wid.^2.*cos(f).*sin(f) + R.^2.*len.^2.*cos(f).^2 + R.^2.*wid.^2.*sin(f).^2 - 2.*R.*len.^2.*n.*cos(f).^2 - 2.*R.*n.*wid.^2.*sin(f).^2 + len.^2.*n.^2.*cos(f).^2 + n.^2.*wid.^2.*sin(f).^2).^2);
l(l<0)=0;
L=sqrt(l);
It = It+I0*exp(-L.*RO*50000);
toc

dr=I0.*L./(R1);
%  It=It/I0;
toc;
%  disp(t);
%  
   [x, y] = min(It);
  [x1, y1] = max(It);
  disp(x);
  disp(y);
  plot(R,It);
% title ('Зависимость суммарной интенсивности I от координаты R') 
 xlabel('N, мкм') 
 ylabel('I_t/I_0')

% hold on

